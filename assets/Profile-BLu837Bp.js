import{u as S,j as e,l as y,a as g}from"./index-CtpoxrkX.js";import{b as P,r,L as N}from"./react-vendor-B6jIvKX7.js";import"./icons-5ai6tmcJ.js";const C=()=>{const i=P(),[c,d]=r.useState(""),[m,p]=r.useState(""),[o,h]=r.useState(""),[x,f]=r.useState(""),[u,w]=r.useState([]),[v,j]=r.useState(!0),{showToast:l}=S();r.useEffect(()=>{const s=JSON.parse(localStorage.getItem("userInfo"));if(!s){i("/login");return}d(s.name),p(s.email),(async()=>{try{const t={headers:{Authorization:`Bearer ${s.token}`}},{data:n}=await g.get("/api/orders/myorders",t);w(n),j(!1)}catch(t){l("Error fetching orders:",t),j(!1)}})()},[i]);const b=async s=>{if(s.preventDefault(),o!==x){l("Passwords do not match");return}try{const t={headers:{"Content-Type":"application/json",Authorization:`Bearer ${JSON.parse(localStorage.getItem("userInfo")).token}`}},{data:n}=await g.put("/api/users/profile",{name:c,email:m,password:o},t);localStorage.setItem("userInfo",JSON.stringify(n)),l("Profile Updated Successfully!"),h(""),f("")}catch(a){l(a),alert(a.response&&a.response.data.message?a.response.data.message:a.message)}};return e.jsx("div",{className:"container",style:{marginTop:"2rem"},children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:window.innerWidth<768?"1fr":"1fr 2fr",gap:"clamp(2rem, 4vw, 4rem)"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{marginBottom:"1.5rem",fontSize:"clamp(1.5rem, 4vw, 2rem)"},children:"User Profile"}),e.jsxs("form",{onSubmit:b,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Name"}),e.jsx("input",{type:"text",className:"form-control",value:c,onChange:s=>d(s.target.value)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Email Address"}),e.jsx("input",{type:"email",className:"form-control",value:m,onChange:s=>p(s.target.value)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Password"}),e.jsx("input",{type:"password",className:"form-control",placeholder:"Enter password",value:o,onChange:s=>h(s.target.value)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Confirm Password"}),e.jsx("input",{type:"password",className:"form-control",placeholder:"Confirm password",value:x,onChange:s=>f(s.target.value)})]}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Update"})]})]}),e.jsxs("div",{children:[e.jsx("h2",{style:{marginBottom:"1.5rem",fontSize:"clamp(1.5rem, 4vw, 2rem)"},children:"My Orders"}),v?e.jsx("div",{children:"Loading orders..."}):u.length===0?e.jsxs("div",{children:["No orders yet. ",e.jsx(N,{to:"/shop",children:"Start Shopping"})]}):e.jsx("div",{style:{overflowX:"auto",WebkitOverflowScrolling:"touch"},children:e.jsxs("table",{style:{width:"100%",minWidth:"500px",borderCollapse:"collapse",fontSize:window.innerWidth<768?"0.875rem":"1rem"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderBottom:"2px solid #eee",textAlign:"left"},children:[e.jsx("th",{className:"py-1",style:{display:window.innerWidth<768?"none":"table-cell"},children:"ID"}),e.jsx("th",{className:"py-1",children:"DATE"}),e.jsx("th",{className:"py-1",children:"TOTAL"}),e.jsx("th",{className:"py-1",children:"PAID"}),e.jsx("th",{className:"py-1",children:"DELIVERED"}),e.jsx("th",{className:"py-1"})]})}),e.jsx("tbody",{children:u.map(s=>e.jsxs("tr",{style:{borderBottom:"1px solid #eee"},children:[e.jsx("td",{className:"py-1",style:{display:window.innerWidth<768?"none":"table-cell"},children:s._id}),e.jsx("td",{className:"py-1",children:new Date(s.createdAt).toLocaleDateString()}),e.jsxs("td",{className:"py-1",children:["Rs ",s.totalPrice]}),e.jsx("td",{className:"py-1",children:s.isPaid?e.jsx("span",{style:{color:"green"},children:"Paid"}):e.jsx(y,{style:{color:"red"}})}),e.jsx("td",{className:"py-1",children:s.isDelivered?e.jsx("span",{style:{color:"green"},children:"Delivered"}):e.jsx(y,{style:{color:"red"}})}),e.jsx("td",{className:"py-1",children:e.jsx(N,{to:`/order/${s._id}`,className:"btn btn-outline",style:{padding:"5px 10px",fontSize:"0.875rem",whiteSpace:"nowrap"},children:"Details"})})]},s._id))})]})})]})]})})};export{C as default};
