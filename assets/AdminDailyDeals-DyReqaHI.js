import{u as A,j as r,l as z,s as P,a as l}from"./index-PvAz_UZ7.js";import{r as o,L as B}from"./react-vendor-B6jIvKX7.js";import"./icons-5ai6tmcJ.js";const M=()=>{const[p,c]=o.useState([]),[w,S]=o.useState([]),[N,x]=o.useState(!0),[m,h]=o.useState(!1),[y,f]=o.useState(""),[b,j]=o.useState(""),[u,v]=o.useState(""),[g,D]=o.useState({show:!1,dealId:null,dealName:null}),{showToast:n}=A();o.useEffect(()=>{(async()=>{try{const[t,a]=await Promise.all([l.get("/api/dailydeals"),l.get("/api/products")]);c(t.data),S(a.data),x(!1)}catch(t){console.error("Error fetching data:",t),n("Error loading data","error"),x(!1)}})()},[n]);const C=async e=>{var t;e.preventDefault();try{const s={headers:{"Content-Type":"application/json",Authorization:`Bearer ${JSON.parse(localStorage.getItem("userInfo")).token}`}},d=u?parseFloat(u):0;if(isNaN(d)||d<0||d>100){n("Discount percentage must be a number between 0 and 100","error");return}await l.post("/api/dailydeals",{product:y,endTime:b,discountPercentage:d},s),n("Daily deal created successfully!","success"),h(!1),f(""),j(""),v("");const{data:E}=await l.get("/api/dailydeals");c(E)}catch(a){console.error("Error creating daily deal:",a);let s="Error creating daily deal";(t=a.response)!=null&&t.data?s=a.response.data.message||a.response.data.error||(typeof a.response.data=="string"?a.response.data:s):a.message&&(s=a.message),n(s,"error")}},T=(e,t)=>{D({show:!0,dealId:e,dealName:t})},i=()=>{D({show:!1,dealId:null,dealName:null})},k=async()=>{const{dealId:e}=g;if(e)try{const a={headers:{Authorization:`Bearer ${JSON.parse(localStorage.getItem("userInfo")).token}`}};await l.delete(`/api/dailydeals/${e}`,a),n("Daily deal deleted successfully!","success"),i();const{data:s}=await l.get("/api/dailydeals");c(s)}catch(t){console.error("Error deleting daily deal:",t),n("Error deleting daily deal","error"),i()}},I=async e=>{try{const a={headers:{"Content-Type":"application/json",Authorization:`Bearer ${JSON.parse(localStorage.getItem("userInfo")).token}`}};await l.put(`/api/dailydeals/${e._id}`,{isActive:!e.isActive},a),n("Daily deal updated successfully!","success");const{data:s}=await l.get("/api/dailydeals");c(s)}catch(t){console.error("Error updating daily deal:",t),n("Error updating daily deal","error")}};return N?r.jsx("div",{className:"container",style:{marginTop:"2rem",textAlign:"center"},children:r.jsx("p",{children:"Loading..."})}):r.jsxs("div",{className:"container",style:{marginTop:"2rem",maxWidth:"1200px",padding:"0 1rem"},children:[r.jsx(B,{to:"/admin/dashboard",className:"btn btn-outline",style:{marginBottom:"1rem"},children:"â† Back to Dashboard"}),r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"2rem"},children:[r.jsx("h1",{style:{fontSize:"clamp(1.5rem, 5vw, 2rem)"},children:"Daily Deals Management"}),r.jsx("button",{className:"btn btn-primary",onClick:()=>h(!m),children:m?"Cancel":"+ Add Daily Deal"})]}),m&&r.jsxs("div",{className:"card",style:{padding:"2rem",marginBottom:"2rem"},children:[r.jsx("h2",{style:{marginBottom:"1.5rem"},children:"Create New Daily Deal"}),r.jsxs("form",{onSubmit:C,children:[r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{className:"form-label",children:["Product ",r.jsx("span",{style:{color:"red"},children:"*"})]}),r.jsxs("select",{className:"form-control",value:y,onChange:e=>f(e.target.value),required:!0,children:[r.jsx("option",{value:"",children:"Select a product"}),w.map(e=>r.jsxs("option",{value:e._id,children:[e.name," - Rs ",e.price]},e._id))]})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{className:"form-label",children:["Deal End Time ",r.jsx("span",{style:{color:"red"},children:"*"})]}),r.jsx("input",{type:"datetime-local",className:"form-control",value:b,onChange:e=>j(e.target.value),required:!0,min:new Date().toISOString().slice(0,16)})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{className:"form-label",children:["Discount Percentage ",r.jsx("span",{style:{color:"red"},children:"*"})]}),r.jsx("input",{type:"number",className:"form-control",value:u,onChange:e=>v(e.target.value),required:!0,min:"0",max:"100",step:"0.01",placeholder:"e.g., 20 for 20% off"}),r.jsx("small",{style:{color:"#666",fontSize:"0.85rem",marginTop:"0.25rem",display:"block"},children:"Enter the discount percentage (0-100). The discounted price will be calculated automatically."})]}),r.jsx("button",{type:"submit",className:"btn btn-primary btn-block",children:"Create Daily Deal"})]})]}),r.jsxs("div",{className:"card",style:{padding:"2rem"},children:[r.jsx("h2",{style:{marginBottom:"1.5rem"},children:"Active Daily Deals"}),p.length===0?r.jsx("p",{style:{textAlign:"center",color:"#666",padding:"2rem"},children:"No daily deals found. Create one above."}):r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:p.map(e=>r.jsx("div",{className:"card",style:{padding:"1.5rem",border:`2px solid ${e.isActive?"var(--accent-color)":"#e2e8f0"}`,opacity:e.isActive?1:.7},children:r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr auto auto",gap:"1rem",alignItems:"center"},children:[r.jsx("div",{children:e.product?r.jsxs(r.Fragment,{children:[r.jsx("h3",{style:{marginBottom:"0.5rem"},children:e.product.name}),r.jsxs("p",{style:{color:"#666",marginBottom:"0.5rem"},children:["Original Price: Rs ",e.product.price,e.discountPercentage>0&&r.jsxs(r.Fragment,{children:[r.jsx("br",{}),"Discount: ",e.discountPercentage,"% off",r.jsx("br",{}),r.jsxs("strong",{style:{color:"var(--accent-color)"},children:["Deal Price: Rs ",(e.product.price*(1-e.discountPercentage/100)).toFixed(2)]})]})]}),r.jsxs("p",{style:{color:"#666",fontSize:"0.9rem"},children:["Ends: ",new Date(e.endTime).toLocaleString()]})]}):r.jsx("p",{children:"Product not found"})}),r.jsx("button",{className:"btn btn-outline",onClick:()=>I(e),style:{whiteSpace:"nowrap"},children:e.isActive?"Deactivate":"Activate"}),r.jsx("button",{className:"btn",onClick:()=>{var t;return T(e._id,((t=e.product)==null?void 0:t.name)||"this deal")},style:{background:"var(--error-color)",color:"white",whiteSpace:"nowrap"},children:"Delete"})]})},e._id))})]}),g.show&&r.jsx("div",{className:"premium-delete-modal-overlay",onClick:i,style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.75)",backdropFilter:"blur(8px)",WebkitBackdropFilter:"blur(8px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4,padding:"1rem",animation:"fadeIn 0.3s ease"},children:r.jsxs("div",{className:"premium-delete-modal",onClick:e=>e.stopPropagation(),style:{background:"white",borderRadius:"20px",padding:"2rem",maxWidth:"500px",width:"100%",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.3), 0 0 0 1px rgba(0, 0, 0, 0.1)",position:"relative",animation:"zoomIn 0.3s cubic-bezier(0.4, 0, 0.2, 1)",border:"1px solid rgba(210, 168, 65, 0.2)"},children:[r.jsx("button",{onClick:i,style:{position:"absolute",top:"1rem",right:"1rem",background:"transparent",border:"none",fontSize:"1.5rem",color:"#666",cursor:"pointer",width:"32px",height:"32px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%",transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.background="#f3f4f6",e.currentTarget.style.color="#000"},onMouseLeave:e=>{e.currentTarget.style.background="transparent",e.currentTarget.style.color="#666"},"aria-label":"Close",children:r.jsx(z,{})}),r.jsx("div",{style:{display:"flex",justifyContent:"center",marginBottom:"1.5rem"},children:r.jsx("div",{style:{width:"80px",height:"80px",borderRadius:"50%",background:"linear-gradient(135deg, rgba(239, 68, 68, 0.1) 0%, rgba(220, 38, 38, 0.1) 100%)",display:"flex",alignItems:"center",justifyContent:"center",border:"3px solid rgba(239, 68, 68, 0.2)"},children:r.jsx(P,{style:{fontSize:"2.5rem",color:"#ef4444"}})})}),r.jsx("h2",{style:{fontSize:"1.5rem",fontWeight:"700",textAlign:"center",marginBottom:"1rem",color:"#1f2937",letterSpacing:"-0.01em"},children:"Delete Daily Deal?"}),r.jsxs("p",{style:{fontSize:"1rem",color:"#6b7280",textAlign:"center",lineHeight:"1.6",marginBottom:"2rem",padding:"0 1rem"},children:["Are you sure you want to delete ",r.jsxs("strong",{style:{color:"#1f2937"},children:['"',g.dealName,'"']}),"? This action cannot be undone."]}),r.jsxs("div",{style:{display:"flex",gap:"1rem",justifyContent:"center"},children:[r.jsx("button",{onClick:i,className:"premium-modal-cancel-btn",style:{padding:"0.75rem 2rem",borderRadius:"12px",border:"2px solid #e5e7eb",background:"white",color:"#374151",fontSize:"1rem",fontWeight:"600",cursor:"pointer",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",flex:1,maxWidth:"150px"},onMouseEnter:e=>{e.currentTarget.style.background="#f9fafb",e.currentTarget.style.borderColor="#d1d5db",e.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:e=>{e.currentTarget.style.background="white",e.currentTarget.style.borderColor="#e5e7eb",e.currentTarget.style.transform="translateY(0)"},children:"Cancel"}),r.jsx("button",{onClick:k,className:"premium-modal-delete-btn",style:{padding:"0.75rem 2rem",borderRadius:"12px",border:"none",background:"linear-gradient(135deg, #ef4444 0%, #dc2626 100%)",color:"white",fontSize:"1rem",fontWeight:"600",cursor:"pointer",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",boxShadow:"0 4px 12px rgba(239, 68, 68, 0.3)",flex:1,maxWidth:"150px"},onMouseEnter:e=>{e.currentTarget.style.background="linear-gradient(135deg, #dc2626 0%, #b91c1c 100%)",e.currentTarget.style.boxShadow="0 6px 20px rgba(239, 68, 68, 0.4)",e.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:e=>{e.currentTarget.style.background="linear-gradient(135deg, #ef4444 0%, #dc2626 100%)",e.currentTarget.style.boxShadow="0 4px 12px rgba(239, 68, 68, 0.3)",e.currentTarget.style.transform="translateY(0)"},children:"Delete"})]})]})})]})};export{M as default};
