import{u as W,j as e,a as b}from"./index-PvAz_UZ7.js";import{e as A,b as H,r as s,L as J}from"./react-vendor-B6jIvKX7.js";import"./icons-5ai6tmcJ.js";const G=()=>{const{id:p}=A(),M=H(),[v,N]=s.useState(""),[l,g]=s.useState(0),[o,h]=s.useState(0),[m,i]=s.useState(0),[n,y]=s.useState(!1),[S,f]=s.useState(""),[P,C]=s.useState(""),[k,I]=s.useState(""),[E,w]=s.useState(0),[B,D]=s.useState(""),[T,x]=s.useState(!1),{showToast:u}=W();s.useEffect(()=>{(async()=>{try{const{data:a}=await b.get(`/api/products/${p}`);N(a.name),g(a.price),h(a.originalPrice||a.price),i(a.discountPercentage||0),y(a.isOnSale||!1),f(a.image),C(a.brand),I(a.category),w(a.countInStock),D(a.description)}catch(a){u("Error fetching product:",a)}})()},[p]);const U=async t=>{var F,O;const a=t.target.files[0];if(!a)return;const r=new FormData;r.append("image",a),x(!0);try{const c=JSON.parse(localStorage.getItem("userInfo")),j={headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${c==null?void 0:c.token}`}},{data:d}=await b.post("/api/upload",r,j),z=typeof d=="string"?d:d.imageUrl||d;f(z),x(!1),u("Image uploaded successfully!","success")}catch(c){const j=((O=(F=c.response)==null?void 0:F.data)==null?void 0:O.message)||c.message||"Error uploading image";u(j,"error"),x(!1)}},$=async t=>{t.preventDefault();try{const r={headers:{"Content-Type":"application/json",Authorization:`Bearer ${JSON.parse(localStorage.getItem("userInfo")).token}`}};await b.put(`/api/products/${p}`,{name:v,price:l,originalPrice:n?o:null,discountPercentage:n?m:0,isOnSale:n,image:S,brand:P,category:k,countInStock:E,description:B},r),M("/admin/products")}catch(a){u("Error updating product:",a)}};return e.jsxs("div",{className:"container",style:{marginTop:"2rem",maxWidth:"min(600px, 95vw)",padding:"0 1rem"},children:[e.jsx(J,{to:"/admin/products",className:"btn btn-outline",style:{marginBottom:"1rem"},children:"Go Back"}),e.jsx("h1",{style:{fontSize:"clamp(1.5rem, 5vw, 2rem)",marginBottom:"1.5rem"},children:"Edit Product"}),e.jsxs("form",{onSubmit:$,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Name"}),e.jsx("input",{type:"text",className:"form-control",value:v,onChange:t=>N(t.target.value)})]}),e.jsx("div",{className:"form-group",children:e.jsxs("label",{className:"form-label",children:[e.jsx("input",{type:"checkbox",checked:n,onChange:t=>{y(t.target.checked),t.target.checked||(i(0),h(l))},style:{marginRight:"8px"}}),"Product is on Sale"]})}),n&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Original Price (Before Discount)"}),e.jsx("input",{type:"number",className:"form-control",value:o,onChange:t=>{const a=parseFloat(t.target.value)||0;if(h(a),a>0&&l>0){const r=Math.round((a-l)/a*100);i(r)}},placeholder:"Enter original price"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Discount Percentage (%)"}),e.jsx("input",{type:"number",className:"form-control",value:m,onChange:t=>{const a=parseFloat(t.target.value)||0;if(i(a),o>0&&a>0){const r=o*(1-a/100);g(Math.round(r*100)/100)}},min:"0",max:"100",placeholder:"Enter discount percentage"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Current Price (Sale Price if on sale)"}),e.jsx("input",{type:"number",className:"form-control",value:l,onChange:t=>{const a=parseFloat(t.target.value)||0;if(g(a),n&&o>0&&a>0){const r=Math.round((o-a)/o*100);i(r)}}}),n&&o>0&&e.jsx("small",{style:{color:"#666",marginTop:"4px",display:"block"},children:m>0?`${m}% OFF`:"No discount calculated"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Image"}),e.jsx("input",{type:"text",className:"form-control",value:S,onChange:t=>f(t.target.value),style:{marginBottom:"10px"}}),e.jsx("input",{type:"file",onChange:U,className:"form-control",accept:"image/*"}),T&&e.jsx("div",{children:"Uploading..."})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Brand"}),e.jsx("input",{type:"text",className:"form-control",value:P,onChange:t=>C(t.target.value)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Category"}),e.jsxs("select",{className:"form-control",value:k,onChange:t=>I(t.target.value),children:[e.jsx("option",{value:"",children:"Select Category"}),e.jsx("option",{value:"Men",children:"Men"}),e.jsx("option",{value:"Women",children:"Women"}),e.jsx("option",{value:"Kids",children:"Kids"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Count In Stock"}),e.jsx("input",{type:"number",className:"form-control",value:E,onChange:t=>w(t.target.value)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Description"}),e.jsx("textarea",{className:"form-control",value:B,onChange:t=>D(t.target.value),rows:"3"})]}),e.jsx("button",{type:"submit",className:"btn btn-primary btn-block",children:"Update"})]})]})};export{G as default};
